(function(e){function t(t){for(var n,a,c=t[0],u=t[1],l=t[2],m=0,d=[];m<c.length;m++)a=c[m],Object.prototype.hasOwnProperty.call(s,a)&&s[a]&&d.push(s[a][0]),s[a]=0;for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(e[n]=u[n]);i&&i(t);while(d.length)d.shift()();return o.push.apply(o,l||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],n=!0,c=1;c<r.length;c++){var u=r[c];0!==s[u]&&(n=!1)}n&&(o.splice(t--,1),e=a(a.s=r[0]))}return e}var n={},s={app:0},o=[];function a(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=n,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(r,n,function(t){return e[t]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var i=u;o.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"38c8":function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("7a23"),s=r("be92"),o={mounted:function(e){e.focus()},updated:function(e){e.focus()}},a=function(e){e.directive("focus",o)};function c(e,t,r,s,o,a){var c=Object(n["resolveComponent"])("AppChat");return Object(n["openBlock"])(),Object(n["createBlock"])(c)}function u(e,t,r,s,o,a){var c=Object(n["resolveComponent"])("JoinForm"),u=Object(n["resolveComponent"])("ChatInterface");return s.isJoined?(Object(n["openBlock"])(),Object(n["createBlock"])(u,{key:1,users:s.users,messages:s.messages,onSend:s.sendMessage},null,8,["users","messages","onSend"])):(Object(n["openBlock"])(),Object(n["createBlock"])(c,{key:0,onEnter:s.enterChat},null,8,["onEnter"]))}r("96cf");var l=r("1da1"),i=r("5530"),m=Object(s["b"])({id:"chat",state:function(){return{roomId:null,username:null,users:[],messages:[]}},getters:{getUsers:function(e){return e.users},getMessages:function(e){return e.messages}},actions:{setUsers:function(e){this.users=e},setRoomId:function(e){this.roomId=e},setActualUser:function(e){this.username=e},addMessage:function(e){var t=Object(i["a"])({},e);this.messages.push(t)}}}),d=r("bc3a"),b=r.n(d),p=r("daa8"),f=Object(p["a"])("http://localhost:3000"),j=f,O={key:0,class:"join__err"},g={key:1,class:"join__err"},h=["disabled"];function v(e,t,r,s,o,a){return Object(n["openBlock"])(),Object(n["createElementBlock"])("form",{class:"join",onSubmit:t[4]||(t[4]=Object(n["withModifiers"])((function(){return s.chatEnter&&s.chatEnter.apply(s,arguments)}),["prevent"]))},[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{class:Object(n["normalizeClass"])(["join__input",{invalid:s.roomIdErr}]),type:"text",placeholder:"ID комнаты","onUpdate:modelValue":t[0]||(t[0]=function(e){return s.roomId=e}),onBlur:t[1]||(t[1]=function(){return s.roomIdBlur&&s.roomIdBlur.apply(s,arguments)})},null,34),[[n["vModelText"],s.roomId]]),s.roomIdErr?(Object(n["openBlock"])(),Object(n["createElementBlock"])("small",O,Object(n["toDisplayString"])(s.roomIdErr),1)):Object(n["createCommentVNode"])("",!0),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{class:Object(n["normalizeClass"])(["join__input",{invalid:s.usernameErr}]),type:"text",placeholder:"Ваше имя","onUpdate:modelValue":t[2]||(t[2]=function(e){return s.username=e}),onBlur:t[3]||(t[3]=function(){return s.usernameBlur&&s.usernameBlur.apply(s,arguments)})},null,34),[[n["vModelText"],s.username]]),s.usernameErr?(Object(n["openBlock"])(),Object(n["createElementBlock"])("small",g,Object(n["toDisplayString"])(s.usernameErr),1)):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("button",{class:"join__btn btn",disabled:s.isSubmitting},Object(n["toDisplayString"])(s.isSubmitting?"Вход...":"Войти"),9,h)],32)}r("498a");var _=r("506a"),y=r("7bb1"),E={setup:function(e,t){var r=t.emit,n=Object(y["b"])(),s=n.handleSubmit,o=n.isSubmitting,a=Object(y["a"])("roomId",_["a"]().trim().required("Это поле обязательно").min(3,"Введите минимум 3 символа")),c=a.value,u=a.errorMessage,l=a.handleBlur,i=Object(y["a"])("username",_["a"]().trim().required("Это поле обязательно").min(3,"Введите минимум 3 символа")),d=i.value,b=i.errorMessage,p=i.handleBlur,f=m(),j=s((function(e){var t=e.roomId,n=e.username;f.setRoomId(t),r("enter",{roomId:t,username:n})}));return{roomId:c,username:d,roomIdErr:u,usernameErr:b,roomIdBlur:l,usernameBlur:p,chatEnter:j,isSubmitting:o}}};r("cd64");E.render=v;var k=E,B=function(e){return Object(n["pushScopeId"])("data-v-4f33b5d0"),e=e(),Object(n["popScopeId"])(),e},I={class:"chat"},M={class:"chat__users users"},S={class:"users__count"},x=B((function(){return Object(n["createElementVNode"])("hr",{style:{"margin-bottom":"1rem"}},null,-1)})),w={class:"users__list"},V={class:"chat__messages messages"},C={class:"messages__list",ref:"messageContainer"},N={class:"messages__text"},D={class:"messages__sender"},U=B((function(){return Object(n["createElementVNode"])("button",{class:"messages__btn btn"},"Отправить",-1)}));function A(e,t,r,s,o,a){var c=Object(n["resolveDirective"])("focus");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",I,[Object(n["createElementVNode"])("div",M,[Object(n["createElementVNode"])("h2",S,Object(n["toDisplayString"])(r.users.length)+" "+Object(n["toDisplayString"])(r.users.length>1?"Users":"User"),1),x,Object(n["createElementVNode"])("ul",w,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(r.users,(function(e){return Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{class:"users__user",key:e},Object(n["toDisplayString"])(e),1)})),128))])]),Object(n["createElementVNode"])("div",V,[Object(n["createElementVNode"])("ul",C,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(r.messages,(function(e){return Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{class:Object(n["normalizeClass"])(["messages__item",{messages__item_right:e.username===s.storeChat.username}]),key:e},[Object(n["createElementVNode"])("span",N,Object(n["toDisplayString"])(e.text),1),Object(n["createElementVNode"])("small",D,Object(n["toDisplayString"])(e.username),1)],2)})),128))],512),Object(n["createElementVNode"])("form",{class:"messages__form",onSubmit:t[1]||(t[1]=Object(n["withModifiers"])((function(){return s.sendMessage&&s.sendMessage.apply(s,arguments)}),["prevent"]))},[Object(n["withDirectives"])(Object(n["createElementVNode"])("textarea",{class:"messages__area","onUpdate:modelValue":t[0]||(t[0]=function(e){return s.textMessage=e}),placeholder:"Введите сообщение"},null,512),[[c],[n["vModelText"],s.textMessage]]),U],32)])])}r("4795");var P={props:{users:{type:Array,required:!0},messages:{type:Array,default:[]}},setup:function(e,t){var r=t.emit,s=m(),o=Object(n["ref"])(o),a=Object(n["ref"])(""),c=function(){a.value&&(r("send",a.value),a.value="")};return Object(n["watch"])(e.messages,(function(){setTimeout((function(){o.value.scrollTo({top:99999,left:0,behavior:"smooth"})}),0)})),{textMessage:a,sendMessage:c,messageContainer:o,storeChat:s}}};r("e02c");P.render=A,P.__scopeId="data-v-4f33b5d0";var T=P,J={setup:function(){var e=Object(n["ref"])(!1),t=m(),r=function(){var r=Object(l["a"])(regeneratorRuntime.mark((function r(n){var s,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,b.a.post("http://localhost:3000/rooms",n);case 2:return e.value=!0,j.emit("join",n),r.next=6,b.a.get("http://localhost:3000/rooms/".concat(n.roomId));case 6:s=r.sent,o=s.data,t.setActualUser(o.users[o.users.length-1]),t.setUsers(o.users);case 10:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),s=function(e){t.addMessage({text:e,username:t.username}),j.emit("newMessage",{roomId:t.roomId,username:t.username,text:e})};j.on("setUsers",(function(e){t.setUsers(e)})),j.on("newMessage",(function(e){t.addMessage(e)}));var o=Object(n["computed"])((function(){return t.getUsers})),a=Object(n["computed"])((function(){return t.getMessages}));return{isJoined:e,enterChat:r,sendMessage:s,users:o,messages:a}},components:{JoinForm:k,ChatInterface:T}};J.render=u;var F=J,R={components:{AppChat:F}};R.render=c;var q=R,z=(r("38c8"),Object(s["a"])());Object(n["createApp"])(q).use(z).use(a).mount("#app")},"99ad":function(e,t,r){},cd64:function(e,t,r){"use strict";r("99ad")},e02c:function(e,t,r){"use strict";r("ed3f")},ed3f:function(e,t,r){}});
//# sourceMappingURL=app.5aa5d389.js.map